<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VPS Builder Game - Build Your Virtual Server</title>
    <style>
        body {
            background-color: #f8f9fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 0;
            padding-top: 60px;
        }
        .topnav {
            background-color: #333;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
        }
        .topnav a {
            float: left;
            color: #f2f2f2;
            text-align: center;
            padding: 14px 16px;
            text-decoration: none;
            font-size: 17px;
            transition: background-color 0.3s;
        }
        .topnav a:hover {
            background-color: #ddd;
            color: black;
        }
        .topnav a.active {
            background-color: #28a745;
            color: white;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        h1 {
            color: #28a745;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
        }
        .game-container {
            display: flex;
            gap: 20px;
            height: 80vh;
        }
        .components-panel {
            width: 300px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 20px;
            overflow-y: auto;
        }
        .build-area {
            flex: 1;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 20px;
            position: relative;
            min-height: 600px;
            border: 2px dashed #ccc;
        }
        .component {
            background: #e9ecef;
            border: 2px solid #6c757d;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            cursor: grab;
            transition: all 0.3s ease;
            user-select: none;
        }
        .component:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .component:active {
            cursor: grabbing;
        }
        .component.cpu { background: #d4edda; border-color: #28a745; }
        .component.ram { background: #d1ecf1; border-color: #17a2b8; }
        .component.storage { background: #fff3cd; border-color: #ffc107; }
        .component.network { background: #f8d7da; border-color: #dc3545; }
        .component.gpu { background: #e2e3e5; border-color: #6c757d; }
        .component.security { background: #d1ecf1; border-color: #17a2b8; }
        .component.os { background: #f8d7da; border-color: #dc3545; }
        .component.app { background: #e2e3e5; border-color: #6c757d; }
        .component.motherboard { 
            background: #2c3e50; 
            border-color: #95a5a6; 
            border-width: 3px;
            color: white; 
            font-weight: bold;
            margin: 15px 0;
            position: relative;
            z-index: 1;
        }
        
        .component.motherboard .component-title,
        .component.motherboard .component-desc {
            color: white;
        }
        
        .component.motherboard:hover {
            background: #34495e;
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }
        
        .dropped-component {
            position: absolute;
            background: white;
            border: 2px solid #28a745;
            border-radius: 8px;
            padding: 10px;
            cursor: move;
            min-width: 120px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            z-index: 10;
        }
        
        .connection-point {
            position: absolute;
            width: 12px;
            height: 12px;
            background: #28a745;
            border: 2px solid white;
            border-radius: 50%;
            cursor: pointer;
            z-index: 15;
            transition: all 0.2s ease;
        }
        
        .connection-point:hover {
            background: #ffc107;
            transform: scale(1.2);
        }
        
        .connection-point.connected {
            background: #dc3545;
        }
        
        .connection-line {
            position: absolute;
            background: #28a745;
            height: 3px;
            z-index: 5;
            transform-origin: left center;
        }
        
        .dropped-component.motherboard,
        .build-area .motherboard {
            position: absolute;
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            border: 3px solid #95a5a6;
            border-radius: 15px;
            padding: 20px;
            min-width: 400px;
            min-height: 300px;
            cursor: move;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            z-index: 5;
        }
        
        .motherboard-title {
            color: white;
            font-weight: bold;
            text-align: center;
            margin-bottom: 10px;
            font-size: 16px;
        }
        
        .motherboard-slot {
            position: absolute;
            background: #34495e;
            border: 2px dashed #95a5a6;
            border-radius: 5px;
            padding: 5px;
            font-size: 10px;
            color: #bdc3c7;
            text-align: center;
            min-width: 80px;
            min-height: 20px;
            transition: all 0.3s ease;
        }
        
        .motherboard-slot.drag-over {
            background: #27ae60;
            border-color: #2ecc71;
            transform: scale(1.1);
        }
        
        .motherboard-slot.occupied {
            background: #e74c3c;
            border-color: #c0392b;
            border-style: solid;
        }
        
        .motherboard-slot.occupied .slot-content {
            color: white;
            font-weight: bold;
        }
        
        .motherboard-slot.cpu-slot { top: 50px; left: 50px; }
        .motherboard-slot.ram-slot { top: 50px; right: 50px; }
        .motherboard-slot.storage-slot { bottom: 50px; left: 50px; }
        .motherboard-slot.gpu-slot { bottom: 50px; right: 50px; }
        .motherboard-slot.network-slot { top: 120px; left: 50%; transform: translateX(-50%); }
        .motherboard-slot.security-slot { top: 50%; left: 20px; transform: translateY(-50%); }
        .motherboard-slot.os-slot { top: 50%; right: 20px; transform: translateY(-50%); }
        .motherboard-slot.app-slot { bottom: 120px; left: 50%; transform: translateX(-50%); }
        .dropped-component:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        .dropped-component.cpu { border-color: #28a745; background: #d4edda; }
        .dropped-component.ram { border-color: #17a2b8; background: #d1ecf1; }
        .dropped-component.storage { border-color: #ffc107; background: #fff3cd; }
        .dropped-component.network { border-color: #dc3545; background: #f8d7da; }
        .dropped-component.gpu { border-color: #6c757d; background: #e2e3e5; }
        .dropped-component.security { border-color: #17a2b8; background: #d1ecf1; }
        .dropped-component.os { border-color: #dc3545; background: #f8d7da; }
        .dropped-component.app { border-color: #6c757d; background: #e2e3e5; }
        .dropped-component.motherboard { border-color: #95a5a6; background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%); color: white; }
        
        .component-title {
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 14px;
        }
        .component-desc {
            font-size: 12px;
            color: #666;
        }
        .controls {
            margin-top: 20px;
            text-align: center;
        }
        .btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
        }
        .btn:hover {
            background: #218838;
        }
        .btn.danger {
            background: #dc3545;
        }
        .btn.danger:hover {
            background: #c82333;
        }
        .stats {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
        }
        
        .post-status {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            text-align: center;
        }
        
        .post-indicator {
            display: inline-block;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin-right: 10px;
            animation: pulse 2s infinite;
        }
        
        .post-indicator.success {
            background: #28a745;
            box-shadow: 0 0 10px #28a745;
        }
        
        .post-indicator.error {
            background: #dc3545;
            box-shadow: 0 0 10px #dc3545;
        }
        
        .post-indicator.warning {
            background: #ffc107;
            box-shadow: 0 0 10px #ffc107;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        .connection-line {
            position: absolute;
            background: #28a745;
            height: 2px;
            z-index: 5;
        }
                 .build-area.drag-over {
             border-color: #28a745;
             background-color: #f8fff9;
         }
         
         .component-check-header {
             margin-bottom: 20px;
             padding-bottom: 15px;
             border-bottom: 2px solid #e9ecef;
         }
         
         .component-check-section {
             display: flex;
             align-items: center;
             gap: 15px;
             margin-top: 15px;
             padding: 10px;
             background: #f8f9fa;
             border-radius: 8px;
         }
         
         .check-btn {
             background: #17a2b8;
             color: white;
             border: none;
             padding: 8px 16px;
             border-radius: 5px;
             cursor: pointer;
             font-size: 14px;
             white-space: nowrap;
         }
         
         .check-btn:hover {
             background: #138496;
         }
         
         .component-status {
             display: flex;
             align-items: center;
             flex: 1;
         }
    </style>
</head>
<body>
    <div class="topnav">
        <a href="index.html">Home</a>
        <a href="google_cloud.html">Google Cloud</a>
        <a href="kamatera.html">Kamatera</a>
        <a href="oracle_cloud.html">Oracle Cloud</a>
        <a href="whats_a_vps.html">What's a VPS</a>
        <a class="active" href="#vm_maker">VPS Builder</a>
    </div> 
    
    <div class="container">
        <h1>🖥️ VPS Builder Game</h1>
        <p style="text-align: center; margin-bottom: 30px;">Drag and drop components to build your virtual server! Create the perfect VPS configuration.</p>
        
        <div class="game-container">
            <div class="components-panel">
                <h3>📦 Available Components</h3>
                
                <div class="component cpu" draggable="true" data-type="cpu">
                    <div class="component-title">🖥️ CPU - Intel i7-12700K</div>
                    <div class="component-desc">8 cores, 16 threads, 3.6GHz base</div>
                </div>
                
                <div class="component cpu" draggable="true" data-type="cpu">
                    <div class="component-title">🖥️ CPU - AMD Ryzen 9 5900X</div>
                    <div class="component-desc">12 cores, 24 threads, 3.7GHz base</div>
                </div>
                
                <div class="component ram" draggable="true" data-type="ram">
                    <div class="component-title">💾 RAM - 16GB DDR4</div>
                    <div class="component-desc">3200MHz, Dual Channel</div>
                </div>
                
                <div class="component ram" draggable="true" data-type="ram">
                    <div class="component-title">💾 RAM - 32GB DDR4</div>
                    <div class="component-desc">3600MHz, Dual Channel</div>
                </div>
                
                <div class="component storage" draggable="true" data-type="storage">
                    <div class="component-title">💿 SSD - 500GB NVMe</div>
                    <div class="component-desc">3500MB/s read, 3000MB/s write</div>
                </div>
                
                <div class="component storage" draggable="true" data-type="storage">
                    <div class="component-title">💿 SSD - 1TB NVMe</div>
                    <div class="component-desc">7000MB/s read, 5300MB/s write</div>
                </div>
                
                <div class="component storage" draggable="true" data-type="storage">
                    <div class="component-title">💿 HDD - 2TB SATA</div>
                    <div class="component-desc">7200RPM, 200MB/s transfer</div>
                </div>
                
                <div class="component network" draggable="true" data-type="network">
                    <div class="component-title">🌐 Network - 1Gbps</div>
                    <div class="component-desc">Gigabit Ethernet connection</div>
                </div>
                
                <div class="component network" draggable="true" data-type="network">
                    <div class="component-title">🌐 Network - 10Gbps</div>
                    <div class="component-desc">10 Gigabit Ethernet connection</div>
                </div>
                
                <div class="component gpu" draggable="true" data-type="gpu">
                    <div class="component-title">🎮 GPU - RTX 3080</div>
                    <div class="component-desc">10GB GDDR6X, Ray Tracing</div>
                </div>
                
                <div class="component gpu" draggable="true" data-type="gpu">
                    <div class="component-title">🎮 GPU - RTX 4090</div>
                    <div class="component-desc">24GB GDDR6X, AI Acceleration</div>
                </div>
                
                <div class="component security" draggable="true" data-type="security">
                    <div class="component-title">🔒 Firewall</div>
                    <div class="component-desc">Advanced packet filtering</div>
                </div>
                
                <div class="component security" draggable="true" data-type="security">
                    <div class="component-title">🔒 DDoS Protection</div>
                    <div class="component-desc">10Gbps attack mitigation</div>
                </div>
                
                <div class="component os" draggable="true" data-type="os">
                    <div class="component-title">🐧 Ubuntu Server 22.04</div>
                    <div class="component-desc">LTS, Long-term support</div>
                </div>
                
                <div class="component os" draggable="true" data-type="os">
                    <div class="component-title">🪟 Windows Server 2022</div>
                    <div class="component-desc">Enterprise edition</div>
                </div>
                
                <div class="component app" draggable="true" data-type="app">
                    <div class="component-title">🌐 Web Server (Apache)</div>
                    <div class="component-desc">HTTP/HTTPS server</div>
                </div>
                
                <div class="component app" draggable="true" data-type="app">
                    <div class="component-title">🗄️ Database (MySQL)</div>
                    <div class="component-desc">Relational database</div>
                </div>
                
                <div class="component app" draggable="true" data-type="app">
                    <div class="component-title">🎮 Game Server</div>
                    <div class="component-desc">Multiplayer gaming</div>
                </div>
                
                <div class="component motherboard" draggable="true" data-type="motherboard">
                    <div class="component-title">🔌 Motherboard - ATX</div>
                    <div class="component-desc">Main circuit board with slots</div>
                </div>
                
                <div class="controls">
                    <button class="btn" onclick="clearBuildArea()">🗑️ Clear All</button>
                    <button class="btn" onclick="saveConfiguration()">💾 Save Config</button>
                    <button class="btn" onclick="loadConfiguration()">📂 Load Config</button>
                    <button class="btn" onclick="exportToFile()">📄 Export .cfg</button>
                    <button class="btn" onclick="importFromFile()">📥 Import .cfg</button>
                    <button class="btn" onclick="checkComponents()">🔍 Check Components</button>
                </div>
                
                <div class="stats">
                    <h4>📊 Server Stats</h4>
                    <div id="server-stats">
                        <p>Components: <span id="component-count">0</span></p>
                        <p>Total Cost: $<span id="total-cost">0</span></p>
                        <p>Performance Score: <span id="performance-score">0</span>/100</p>
                    </div>
                </div>
                

            </div>
            
                         <div class="build-area" id="build-area">
                 <div class="component-check-header">
                     <h3>🏗️ Build Your VPS Here</h3>
                     <p>Drag components from the left panel and drop them here to build your virtual server!</p>
                     
                     <div class="component-check-section">
                         <button class="btn check-btn" onclick="checkComponents()">🔍 Check Components</button>
                         <div class="component-status">
                             <div class="post-indicator error"></div>
                             <span id="post-message">Click "Check Components" to verify system</span>
                         </div>
                     </div>
                 </div>
             </div>
        </div>
    </div>

    <script>
                 let droppedComponents = [];
         let componentCounter = 0;
         let isDragging = false;
         let draggedElement = null;
         let offsetX, offsetY;
         let connections = [];
         let selectedConnectionPoint = null;
         let currentDraggedComponent = null;

        // Component pricing
        const componentPrices = {
            'cpu': { 'Intel i7-12700K': 350, 'AMD Ryzen 9 5900X': 450 },
            'ram': { '16GB DDR4': 80, '32GB DDR4': 150 },
            'storage': { '500GB NVMe': 60, '1TB NVMe': 120, '2TB SATA': 50 },
            'network': { '1Gbps': 10, '10Gbps': 50 },
            'gpu': { 'RTX 3080': 700, 'RTX 4090': 1600 },
            'security': { 'Firewall': 20, 'DDoS Protection': 100 },
            'os': { 'Ubuntu Server 22.04': 0, 'Windows Server 2022': 200 },
            'app': { 'Web Server (Apache)': 0, 'Database (MySQL)': 0, 'Game Server': 0 },
            'motherboard': { 'Motherboard - ATX': 150 }
        };

        // Performance scores
        const performanceScores = {
            'cpu': { 'Intel i7-12700K': 25, 'AMD Ryzen 9 5900X': 30 },
            'ram': { '16GB DDR4': 15, '32GB DDR4': 20 },
            'storage': { '500GB NVMe': 10, '1TB NVMe': 15, '2TB SATA': 5 },
            'network': { '1Gbps': 5, '10Gbps': 10 },
            'gpu': { 'RTX 3080': 20, 'RTX 4090': 25 },
            'security': { 'Firewall': 5, 'DDoS Protection': 10 },
            'os': { 'Ubuntu Server 22.04': 5, 'Windows Server 2022': 5 },
            'app': { 'Web Server (Apache)': 5, 'Database (MySQL)': 5, 'Game Server': 10 },
            'motherboard': { 'Motherboard - ATX': 10 }
        };

        // Initialize drag and drop
        document.addEventListener('DOMContentLoaded', function() {
            initializeDragAndDrop();
            updateStats();
        });

        function initializeDragAndDrop() {
            const components = document.querySelectorAll('.component');
            const buildArea = document.getElementById('build-area');

            components.forEach(component => {
                component.addEventListener('dragstart', handleDragStart);
                component.addEventListener('dragend', handleDragEnd);
            });

            buildArea.addEventListener('dragover', handleDragOver);
            buildArea.addEventListener('drop', handleDrop);
            buildArea.addEventListener('dragenter', handleDragEnter);
            buildArea.addEventListener('dragleave', handleDragLeave);
        }

                 function handleDragStart(e) {
             e.dataTransfer.setData('text/plain', e.target.outerHTML);
             e.target.style.opacity = '0.5';
             currentDraggedComponent = e.target;
         }

                 function handleDragEnd(e) {
             e.target.style.opacity = '1';
             currentDraggedComponent = null;
         }

        function handleDragOver(e) {
            e.preventDefault();
        }

        function handleDragEnter(e) {
            e.preventDefault();
            e.currentTarget.classList.add('drag-over');
        }

        function handleDragLeave(e) {
            e.currentTarget.classList.remove('drag-over');
        }

        function handleDrop(e) {
            e.preventDefault();
            e.currentTarget.classList.remove('drag-over');
            
            const componentHTML = e.dataTransfer.getData('text/plain');
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = componentHTML;
            const component = tempDiv.firstElementChild;
            
            const rect = e.currentTarget.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            createDroppedComponent(component, x, y);
        }

        function createDroppedComponent(originalComponent, x, y) {
            const buildArea = document.getElementById('build-area');
            const droppedComponent = document.createElement('div');
            
            const componentType = originalComponent.dataset.type;
            const componentTitle = originalComponent.querySelector('.component-title').textContent;
            const componentDesc = originalComponent.querySelector('.component-desc').textContent;
            
                         if (componentType === 'motherboard') {
                 droppedComponent.className = `dropped-component motherboard`;
                 console.log('Creating motherboard with classes:', droppedComponent.className);
                 droppedComponent.innerHTML = `
                     <div class="motherboard-title">🔌 Motherboard - ATX</div>
                     <div class="motherboard-slot cpu-slot" data-slot-type="cpu">
                         <div class="slot-content">CPU Slot</div>
                     </div>
                     <div class="motherboard-slot ram-slot" data-slot-type="ram">
                         <div class="slot-content">RAM Slot</div>
                     </div>
                     <div class="motherboard-slot storage-slot" data-slot-type="storage">
                         <div class="slot-content">Storage Slot</div>
                     </div>
                     <div class="motherboard-slot gpu-slot" data-slot-type="gpu">
                         <div class="slot-content">GPU Slot</div>
                     </div>
                     <div class="motherboard-slot network-slot" data-slot-type="network">
                         <div class="slot-content">Network Slot</div>
                     </div>
                     <div class="motherboard-slot security-slot" data-slot-type="security">
                         <div class="slot-content">Security Slot</div>
                     </div>
                     <div class="motherboard-slot os-slot" data-slot-type="os">
                         <div class="slot-content">OS Slot</div>
                     </div>
                     <div class="motherboard-slot app-slot" data-slot-type="app">
                         <div class="slot-content">App Slot</div>
                     </div>
                     <button onclick="removeComponent(this)" style="position: absolute; top: 5px; right: 5px; background: #dc3545; color: white; border: none; border-radius: 3px; width: 20px; height: 20px; font-size: 12px;">×</button>
                 `;
                 
                 // Add drag and drop listeners to motherboard slots
                 addMotherboardSlotListeners(droppedComponent);
            } else {
                droppedComponent.className = `dropped-component ${componentType}`;
                droppedComponent.innerHTML = `
                    <div class="component-title">${componentTitle}</div>
                    <div class="component-desc">${componentDesc}</div>
                    <button onclick="removeComponent(this)" style="position: absolute; top: 5px; right: 5px; background: #dc3545; color: white; border: none; border-radius: 3px; width: 20px; height: 20px; font-size: 12px;">×</button>
                `;
                
                // Add connection points
                addConnectionPoints(droppedComponent);
            }
            
            droppedComponent.style.left = `${x}px`;
            droppedComponent.style.top = `${y}px`;
            droppedComponent.dataset.id = componentCounter++;
            droppedComponent.dataset.type = componentType;
            droppedComponent.dataset.title = componentTitle;
            
            // Make draggable
            makeDraggable(droppedComponent);
            
            buildArea.appendChild(droppedComponent);
            droppedComponents.push(droppedComponent);
            
            updateStats();
        }

        function makeDraggable(element) {
            element.addEventListener('mousedown', startDragging);
            
            function startDragging(e) {
                if (e.target.tagName === 'BUTTON') return;
                
                isDragging = true;
                draggedElement = element;
                
                const rect = element.getBoundingClientRect();
                offsetX = e.clientX - rect.left;
                offsetY = e.clientY - rect.top;
                
                element.style.zIndex = '1000';
                
                document.addEventListener('mousemove', drag);
                document.addEventListener('mouseup', stopDragging);
            }
            
                    function drag(e) {
            if (!isDragging) return;
            
            const buildArea = document.getElementById('build-area');
            const rect = buildArea.getBoundingClientRect();
            
            let x = e.clientX - rect.left - offsetX;
            let y = e.clientY - rect.top - offsetY;
            
            // Keep within bounds
            x = Math.max(0, Math.min(x, rect.width - element.offsetWidth));
            y = Math.max(0, Math.min(y, rect.height - element.offsetHeight));
            
            element.style.left = `${x}px`;
            element.style.top = `${y}px`;
            
            // Update connection lines for this component
            updateConnectionLines(element);
        }
            
            function stopDragging() {
                isDragging = false;
                draggedElement.style.zIndex = '10';
                draggedElement = null;
                
                document.removeEventListener('mousemove', drag);
                document.removeEventListener('mouseup', stopDragging);
            }
        }


        
        function addMotherboardSlotListeners(motherboard) {
            const slots = motherboard.querySelectorAll('.motherboard-slot');
            
            slots.forEach(slot => {
                slot.addEventListener('dragover', handleSlotDragOver);
                slot.addEventListener('dragenter', handleSlotDragEnter);
                slot.addEventListener('dragleave', handleSlotDragLeave);
                slot.addEventListener('drop', handleSlotDrop);
            });
        }
        
        function handleSlotDragOver(e) {
            e.preventDefault();
        }
        
        function handleSlotDragEnter(e) {
            e.preventDefault();
            const slot = e.currentTarget;
            
            if (currentDraggedComponent) {
                const componentType = currentDraggedComponent.dataset.type;
                const slotType = slot.dataset.slotType;
                
                // Check if component type matches slot type
                if (componentType === slotType && !slot.classList.contains('occupied')) {
                    slot.classList.add('drag-over');
                }
            }
        }
        
        function handleSlotDragLeave(e) {
            e.currentTarget.classList.remove('drag-over');
        }
        
        function handleSlotDrop(e) {
            e.preventDefault();
            const slot = e.currentTarget;
            slot.classList.remove('drag-over');
            
            if (currentDraggedComponent) {
                const componentType = currentDraggedComponent.dataset.type;
                const slotType = slot.dataset.slotType;
                
                // Check if component type matches slot type and slot is not occupied
                if (componentType === slotType && !slot.classList.contains('occupied')) {
                    attachComponentToSlot(currentDraggedComponent, slot);
                }
            }
        }
        
        function attachComponentToSlot(component, slot) {
            // Create a mini version of the component for the slot
            const slotComponent = document.createElement('div');
            slotComponent.className = 'slot-component';
            slotComponent.style.cssText = `
                background: white;
                border: 1px solid #ddd;
                border-radius: 3px;
                padding: 3px;
                font-size: 8px;
                text-align: center;
                color: #333;
                margin: 2px;
            `;
            
            const componentTitle = component.querySelector('.component-title').textContent;
            slotComponent.textContent = componentTitle.split(' - ')[1] || componentTitle.split(' ').slice(1).join(' ');
            
            // Clear slot content and add component
            slot.innerHTML = '';
            slot.appendChild(slotComponent);
            slot.classList.add('occupied');
            slot.dataset.attachedComponent = component.dataset.id;
            
            // Hide the original component
            component.style.display = 'none';
            
            // Add remove button to slot
            const removeBtn = document.createElement('button');
            removeBtn.innerHTML = '×';
            removeBtn.style.cssText = `
                position: absolute;
                top: 2px;
                right: 2px;
                background: #dc3545;
                color: white;
                border: none;
                border-radius: 2px;
                width: 12px;
                height: 12px;
                font-size: 8px;
                cursor: pointer;
            `;
            removeBtn.onclick = () => detachComponentFromSlot(slot, component);
            slot.appendChild(removeBtn);
            
            updateStats();
        }
        
        function detachComponentFromSlot(slot, originalComponent) {
            // Remove component from slot
            slot.innerHTML = '<div class="slot-content">' + slot.dataset.slotType.charAt(0).toUpperCase() + slot.dataset.slotType.slice(1) + ' Slot</div>';
            slot.classList.remove('occupied');
            delete slot.dataset.attachedComponent;
            
            // Show original component
            originalComponent.style.display = 'block';
            
            updateStats();
        }
        
        function addConnectionPoints(component) {
            const positions = [
                { top: '50%', left: '0', transform: 'translateY(-50%) translateX(-50%)' }, // Left
                { top: '0', left: '50%', transform: 'translateX(-50%) translateY(-50%)' }, // Top
                { top: '50%', right: '0', transform: 'translateY(-50%) translateX(50%)' }, // Right
                { bottom: '0', left: '50%', transform: 'translateX(-50%) translateY(50%)' } // Bottom
            ];
            
            positions.forEach((pos, index) => {
                const connectionPoint = document.createElement('div');
                connectionPoint.className = 'connection-point';
                connectionPoint.style.top = pos.top;
                connectionPoint.style.left = pos.left;
                connectionPoint.style.right = pos.right;
                connectionPoint.style.bottom = pos.bottom;
                connectionPoint.style.transform = pos.transform;
                connectionPoint.dataset.side = index;
                connectionPoint.dataset.componentId = component.dataset.id;
                
                connectionPoint.addEventListener('click', handleConnectionPointClick);
                
                component.appendChild(connectionPoint);
            });
        }
        
        function handleConnectionPointClick(e) {
            e.stopPropagation();
            const connectionPoint = e.target;
            
            if (!selectedConnectionPoint) {
                // First connection point selected
                selectedConnectionPoint = connectionPoint;
                connectionPoint.classList.add('connected');
            } else if (selectedConnectionPoint !== connectionPoint) {
                // Second connection point selected - create connection
                createConnection(selectedConnectionPoint, connectionPoint);
                selectedConnectionPoint.classList.remove('connected');
                selectedConnectionPoint = null;
            } else {
                // Same point clicked - deselect
                selectedConnectionPoint.classList.remove('connected');
                selectedConnectionPoint = null;
            }
        }
        
        function createConnection(point1, point2) {
            const buildArea = document.getElementById('build-area');
            const line = document.createElement('div');
            line.className = 'connection-line';
            
            const rect1 = point1.getBoundingClientRect();
            const rect2 = point2.getBoundingClientRect();
            const buildAreaRect = buildArea.getBoundingClientRect();
            
            const x1 = rect1.left + rect1.width / 2 - buildAreaRect.left;
            const y1 = rect1.top + rect1.height / 2 - buildAreaRect.top;
            const x2 = rect2.left + rect2.width / 2 - buildAreaRect.left;
            const y2 = rect2.top + rect2.height / 2 - buildAreaRect.top;
            
            const length = Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));
            const angle = Math.atan2(y2 - y1, x2 - x1) * 180 / Math.PI;
            
            line.style.width = `${length}px`;
            line.style.left = `${x1}px`;
            line.style.top = `${y1}px`;
            line.style.transform = `rotate(${angle}deg)`;
            
            buildArea.appendChild(line);
            
            connections.push({
                line: line,
                point1: point1,
                point2: point2
            });
        }
        
        function removeComponent(button) {
            const component = button.parentElement;
            const index = droppedComponents.indexOf(component);
            if (index > -1) {
                droppedComponents.splice(index, 1);
            }
            
            // If it's a motherboard, remove all attached components
            if (component.classList.contains('motherboard')) {
                const slots = component.querySelectorAll('.motherboard-slot.occupied');
                slots.forEach(slot => {
                    const attachedComponentId = slot.dataset.attachedComponent;
                    const attachedComponent = document.querySelector(`[data-id="${attachedComponentId}"]`);
                    if (attachedComponent) {
                        attachedComponent.remove();
                    }
                });
            }
            
            // Remove connections involving this component
            connections = connections.filter(conn => {
                if (conn.point1.parentElement === component || conn.point2.parentElement === component) {
                    conn.line.remove();
                    return false;
                }
                return true;
            });
            
            component.remove();
            updateStats();
        }

        function clearBuildArea() {
            const buildArea = document.getElementById('build-area');
            const components = buildArea.querySelectorAll('.dropped-component, .motherboard');
            components.forEach(component => component.remove());
            
            // Clear connections
            connections.forEach(conn => conn.line.remove());
            connections = [];
            
            droppedComponents = [];
            selectedConnectionPoint = null;
            updateStats();
        }

        function updateConnectionLines(movedComponent) {
            const buildArea = document.getElementById('build-area');
            const buildAreaRect = buildArea.getBoundingClientRect();
            
            connections.forEach(conn => {
                if (conn.point1.parentElement === movedComponent || conn.point2.parentElement === movedComponent) {
                    const rect1 = conn.point1.getBoundingClientRect();
                    const rect2 = conn.point2.getBoundingClientRect();
                    
                    const x1 = rect1.left + rect1.width / 2 - buildAreaRect.left;
                    const y1 = rect1.top + rect1.height / 2 - buildAreaRect.top;
                    const x2 = rect2.left + rect2.width / 2 - buildAreaRect.left;
                    const y2 = rect2.top + rect2.height / 2 - buildAreaRect.top;
                    
                    const length = Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));
                    const angle = Math.atan2(y2 - y1, x2 - x1) * 180 / Math.PI;
                    
                    conn.line.style.width = `${length}px`;
                    conn.line.style.left = `${x1}px`;
                    conn.line.style.top = `${y1}px`;
                    conn.line.style.transform = `rotate(${angle}deg)`;
                }
            });
        }
        
        function checkComponents() {
            const motherboard = document.querySelector('.dropped-component.motherboard');
            const postIndicator = document.querySelector('.post-indicator');
            const postMessage = document.getElementById('post-message');
            
            if (!motherboard) {
                postIndicator.className = 'post-indicator error';
                postMessage.textContent = 'No motherboard found in build area';
                return;
            }
            
            const requiredSlots = ['cpu', 'ram', 'storage', 'os', 'network', 'security'];
            const missingComponents = [];
            
            requiredSlots.forEach(slotType => {
                const slot = motherboard.querySelector(`[data-slot-type="${slotType}"]`);
                if (!slot.classList.contains('occupied')) {
                    missingComponents.push(slotType.toUpperCase());
                }
            });
            
            if (missingComponents.length > 0) {
                postIndicator.className = 'post-indicator error';
                postMessage.textContent = `Missing: ${missingComponents.join(', ')}`;
            } else {
                postIndicator.className = 'post-indicator success';
                postMessage.textContent = 'All required components installed!';
            }
        }
            
            
        
        function checkCompatibility(motherboard) {
            const issues = [];
            const slots = motherboard.querySelectorAll('.motherboard-slot.occupied');
            
            slots.forEach(slot => {
                const componentId = slot.dataset.attachedComponent;
                const component = document.querySelector(`[data-id="${componentId}"]`);
                
                if (component) {
                    const componentType = component.dataset.type;
                    const componentTitle = component.dataset.title;
                    
                    // Check for specific compatibility issues
                    if (componentType === 'cpu' && componentTitle.includes('AMD') && 
                        !componentTitle.includes('Ryzen')) {
                        issues.push('Legacy AMD CPU');
                    }
                    
                    if (componentType === 'ram' && componentTitle.includes('16GB') && 
                        !componentTitle.includes('DDR4')) {
                        issues.push('Slow RAM speed');
                    }
                    
                    if (componentType === 'storage' && componentTitle.includes('HDD')) {
                        issues.push('HDD instead of SSD');
                    }
                }
            });
            
            return issues;
        }
        
        function updateStats() {
            let totalCost = 0;
            let totalPerformance = 0;
            const componentCount = droppedComponents.length;
            
            droppedComponents.forEach(component => {
                const type = component.dataset.type;
                const title = component.dataset.title;
                
                if (componentPrices[type] && componentPrices[type][title]) {
                    totalCost += componentPrices[type][title];
                }
                
                if (performanceScores[type] && performanceScores[type][title]) {
                    totalPerformance += performanceScores[type][title];
                }
            });
            
                         document.getElementById('component-count').textContent = componentCount;
             document.getElementById('total-cost').textContent = totalCost.toLocaleString();
             document.getElementById('performance-score').textContent = Math.min(totalPerformance, 100);
         }

        function saveConfiguration() {
            const config = {
                components: droppedComponents.map(comp => ({
                    type: comp.dataset.type,
                    title: comp.dataset.title,
                    x: comp.style.left,
                    y: comp.style.top
                })),
                connections: connections.map(conn => ({
                    point1Id: conn.point1.dataset.componentId,
                    point1Side: conn.point1.dataset.side,
                    point2Id: conn.point2.dataset.componentId,
                    point2Side: conn.point2.dataset.side
                }))
            };
            
            localStorage.setItem('vps-configuration', JSON.stringify(config));
            alert('Configuration saved!');
        }

                 function loadConfiguration() {
             const saved = localStorage.getItem('vps-configuration');
             if (saved) {
                 clearBuildArea();
                 const config = JSON.parse(saved);
                 
                 config.components.forEach(comp => {
                     // Find the original component to clone
                     const originalComponent = document.querySelector(`[data-type="${comp.type}"]`);
                     if (originalComponent) {
                         const tempDiv = document.createElement('div');
                         tempDiv.innerHTML = originalComponent.outerHTML;
                         const component = tempDiv.firstElementChild;
                         
                         createDroppedComponent(component, parseInt(comp.x), parseInt(comp.y));
                         
                         // Set position
                         const lastComponent = droppedComponents[droppedComponents.length - 1];
                         lastComponent.style.left = comp.x;
                         lastComponent.style.top = comp.y;
                     }
                 });
                 
                 // Restore connections after components are loaded
                 if (config.connections) {
                     setTimeout(() => {
                         config.connections.forEach(conn => {
                             const point1 = document.querySelector(`[data-component-id="${conn.point1Id}"][data-side="${conn.point1Side}"]`);
                             const point2 = document.querySelector(`[data-component-id="${conn.point2Id}"][data-side="${conn.point2Side}"]`);
                             
                             if (point1 && point2) {
                                 createConnection(point1, point2);
                             }
                         });
                     }, 100);
                 }
                 
                 alert('Configuration loaded!');
             } else {
                 alert('No saved configuration found.');
             }
         }
         
         function exportToFile() {
             const config = {
                 components: droppedComponents.map(comp => ({
                     type: comp.dataset.type,
                     title: comp.dataset.title,
                     x: comp.style.left,
                     y: comp.style.top
                 })),
                 connections: connections.map(conn => ({
                     point1Id: conn.point1.dataset.componentId,
                     point1Side: conn.point1.dataset.side,
                     point2Id: conn.point2.dataset.componentId,
                     point2Side: conn.point2.dataset.side
                 })),
                 metadata: {
                     version: '1.0',
                     exportDate: new Date().toISOString(),
                     totalComponents: droppedComponents.length,
                     totalConnections: connections.length
                 }
             };
             
             const configString = JSON.stringify(config, null, 2);
             const blob = new Blob([configString], { type: 'application/json' });
             const url = URL.createObjectURL(blob);
             
             const a = document.createElement('a');
             a.href = url;
             a.download = `vps-config-${new Date().toISOString().slice(0, 10)}.cfg`;
             document.body.appendChild(a);
             a.click();
             document.body.removeChild(a);
             URL.revokeObjectURL(url);
             
             alert('Configuration exported to .cfg file!');
         }
         
         function importFromFile() {
             const input = document.createElement('input');
             input.type = 'file';
             input.accept = '.cfg,.json';
             
             input.onchange = function(e) {
                 const file = e.target.files[0];
                 if (!file) return;
                 
                 const reader = new FileReader();
                 reader.onload = function(e) {
                     try {
                         const config = JSON.parse(e.target.result);
                         
                         // Validate config structure
                         if (!config.components || !Array.isArray(config.components)) {
                             throw new Error('Invalid configuration file: missing components array');
                         }
                         
                         clearBuildArea();
                         
                         config.components.forEach(comp => {
                             // Find the original component to clone
                             const originalComponent = document.querySelector(`[data-type="${comp.type}"]`);
                             if (originalComponent) {
                                 const tempDiv = document.createElement('div');
                                 tempDiv.innerHTML = originalComponent.outerHTML;
                                 const component = tempDiv.firstElementChild;
                                 
                                 createDroppedComponent(component, parseInt(comp.x), parseInt(comp.y));
                                 
                                 // Set position
                                 const lastComponent = droppedComponents[droppedComponents.length - 1];
                                 lastComponent.style.left = comp.x;
                                 lastComponent.style.top = comp.y;
                             }
                         });
                         
                         // Restore connections after components are loaded
                         if (config.connections && Array.isArray(config.connections)) {
                             setTimeout(() => {
                                 config.connections.forEach(conn => {
                                     const point1 = document.querySelector(`[data-component-id="${conn.point1Id}"][data-side="${conn.point1Side}"]`);
                                     const point2 = document.querySelector(`[data-component-id="${conn.point2Id}"][data-side="${conn.point2Side}"]`);
                                     
                                     if (point1 && point2) {
                                         createConnection(point1, point2);
                                     }
                                 });
                             }, 100);
                         }
                         
                         alert(`Configuration imported successfully!\nComponents: ${config.components.length}\nConnections: ${config.connections ? config.connections.length : 0}`);
                         
                     } catch (error) {
                         alert('Error importing configuration: ' + error.message);
                     }
                 };
                 
                 reader.readAsText(file);
             };
             
             input.click();
         }
    </script>
</body>
</html>
